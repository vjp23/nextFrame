// Script by Vince Petaccio of PetRok Studios. | www.PetRokStudios.com// Ensure a document is openif ( documents.length > 0 ){    // Change dialog settings	var originalDialogMode = app.displayDialogs;	app.displayDialogs = DialogModes.ERROR;    try     {    	// Get the document        var docRef = activeDocument;        // Get the path for the document        var filePath = docRef.path + '/';    		        // Get the filename of the document        var fileNameNoExtension = docRef.name;        // Split the filename at the dots        fileNameNoExtension = fileNameNoExtension.split( "." );        // If there's a dot, remove everything after the last dot        if ( fileNameNoExtension.length > 1 ) {            fileType = fileNameNoExtension[fileNameNoExtension.length-1];            // Decrement the filename object by removing the last element (the stuff after the last .)          	fileNameNoExtension.length--;            // Reconnect everything BEFORE the first .            fileNameNoExtension = fileNameNoExtension.join(".");        }        // Get the last four characters of the filename        lastFour = fileNameNoExtension.slice(-4);        allButFour = fileNameNoExtension.slice(0,-5);        // Check whether the last four characters are digits        newDoc = isNaN(parseInt(lastFour))        // If this is a new document, then add _0000 to the file name        if (newDoc) {            newFileName = fileNameNoExtension + '_0000';                        switch (fileType.toLowerCase()) {                    // Photoshop file                    case 'psd':                        thisSameFile = docRef.path + '/' + newFileName + '.psd';                        saveFile = new File(thisSameFile);                        saveOptions = new PhotoshopSaveOptions();                        saveOptions.embedColorProfile = true;                        saveOptions.layers = true;                        app.activeDocument.saveAs(saveFile,saveOptions,true,Extension.LOWERCASE);                                                app.activeDocument.close(SaveOptions.DONOTSAVECHANGES);                        open(saveFile);                                                break;                                    // JPEG file                    case 'jpg':                        thisSameFile = docRef.path + '/' + newFileName + '.jpg';                        saveFile = new File(thisSameFile);                        saveOptions = new JPEGSaveOptions();                        saveOptions.embedColorProfile = true;                        saveOptions.formatOptions = FormatOptions.STANDARDBASELINE;                        saveOptions.matte = MatteType.NONE;                        saveOptions.quality = 12;                        app.activeDocument.saveAs(saveFile,saveOptions,true,Extension.LOWERCASE);                                                app.activeDocument.close(SaveOptions.DONOTSAVECHANGES);                        open(saveFile);                                                break;                                            // PNG file                    case 'png':                        thisSameFile = docRef.path + '/' + newFileName + '.png';                        saveFile = new File(thisSameFile);                        saveOptions = new PNGSaveOptions();                        saveOptions.compression = 0;                        app.activeDocument.saveAs(saveFile,saveOptions,true,Extension.LOWERCASE);                                                app.activeDocument.close(SaveOptions.DONOTSAVECHANGES);                        open(saveFile);                                                break;                                                // TIFF file                    case 'tif':                        thisSameFile = docRef.path + '/' + newFileName + '.tif';                        saveFile = new File(thisSameFile);                        saveOptions = new TiffSaveOptions();                        saveOptions.embedColorProfile = true;                        saveOptions.layers = false;                        saveOptions.transparency = true;                        app.activeDocument.saveAs(saveFile,saveOptions,true,Extension.LOWERCASE);                        app.activeDocument.close(SaveOptions.DONOTSAVECHANGES);                        open(saveFile);                                                break;                    }        }        // Otherwise, find the lowest number of the file name that does not exist, starting at the index of the file name's digits        else {            // Create the needName switch            needName = 1            // Get the file number            fileNumber = Number(lastFour);            while (needName)            {                // Increment the file number                fileNumber = fileNumber + 1;                            // Make the file number 4 digits with zeros                switch ((fileNumber.toString()).length) {                    case 1:                    newFileName = allButFour + '_000' + fileNumber.toString();                    break;                    case 2:                    newFileName = allButFour + '_00' + fileNumber.toString();                    break;                    case 3:                    newFileName = allButFour + '_0' + fileNumber.toString();                    break;                    case 4:                    newFileName = allButFour + "_" + fileNumber.toString();                    break;                }                switch (fileType.toLowerCase()) {                    // Photoshop file                    case 'psd':                        thisSameFile = docRef.path + '/' + newFileName + '.psd';                        saveFile = new File(thisSameFile);                        if (saveFile.exists) {                            break;                        }                        else {                            saveOptions = new PhotoshopSaveOptions();                            saveOptions.embedColorProfile = true;                            saveOptions.layers = true;                            app.activeDocument.saveAs(saveFile,saveOptions,true,Extension.LOWERCASE);                            needName = 0;                                                        app.activeDocument.close(SaveOptions.DONOTSAVECHANGES);                            open(saveFile);                                                        break;                        }                                    // JPEG file                    case 'jpg':                        thisSameFile = docRef.path + '/' + newFileName + '.jpg';                        saveFile = new File(thisSameFile);                        if (saveFile.exists) {                            break;                        }                        else {                            saveOptions = new JPEGSaveOptions();                            saveOptions.embedColorProfile = true;                            saveOptions.formatOptions = FormatOptions.STANDARDBASELINE;                            saveOptions.matte = MatteType.NONE;                            saveOptions.quality = 12;                            app.activeDocument.saveAs(saveFile,saveOptions,true,Extension.LOWERCASE);                            needName = 0;                                                        app.activeDocument.close(SaveOptions.DONOTSAVECHANGES);                            open(saveFile);                                                        break;                        }                                        // PNG file                    case 'png':                                            thisSameFile = docRef.path + '/' + newFileName + '.png';                        saveFile = new File(thisSameFile);                        if (saveFile.exists) {                            break;                        }                        else {                            saveOptions = new PNGSaveOptions();                            saveOptions.compression = 0;                            app.activeDocument.saveAs(saveFile,saveOptions,true,Extension.LOWERCASE);                            needName = 0;                                                        app.activeDocument.close(SaveOptions.DONOTSAVECHANGES);                            open(saveFile);                                                        break;                        }                                    // TIFF file                    case 'tif':                        thisSameFile = docRef.path + '/' + newFileName + '.tif';                        saveFile = new File(thisSameFile);                        if (saveFile.exists) {                            break;                        }                        else {                            saveOptions = new TiffSaveOptions();                            saveOptions.embedColorProfile = true;                            saveOptions.layers = false;                            saveOptions.transparency = true;                            app.activeDocument.saveAs(saveFile,saveOptions,true,Extension.LOWERCASE);                            needName = 0;                                                        app.activeDocument.close(SaveOptions.DONOTSAVECHANGES);                            open(saveFile);                                                        break;                        }                                    }            }        }    }    catch(e)    {        // An error occured; restore dialog mode and display the error        app.displayDialogs = originalDialogMode;        throw e;    }}else{    alert( "There's no file open! GET TO WORK!!!!");}